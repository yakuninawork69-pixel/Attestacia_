import re

def check_answers(student_file, answer_key):
    """
    –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∑–∞–¥–∞–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç–∞ "–¢–µ—Ä–º–∏–Ω: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ"
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
        student_file (str): –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å –æ—Ç–≤–µ—Ç–∞–º–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞
        answer_key (dict): —Å–ª–æ–≤–∞—Ä—å —Å —ç—Ç–∞–ª–æ–Ω–Ω—ã–º–∏ –æ—Ç–≤–µ—Ç–∞–º–∏ {—Ç–µ—Ä–º–∏–Ω: –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ}
    
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
        tuple: (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–ª–ª–æ–≤, —Å–ø–∏—Å–æ–∫ —Å –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑—å—é)
    """
    score = 0
    feedback = []
    line_counter = 0
    
    with open(student_file, 'r', encoding='utf-8') as f:
        print(f"\nüîç –ê–Ω–∞–ª–∏–∑ —Ñ–∞–π–ª–∞: {student_file}")
        print("=" * 50)
        
        for line in f:
            line_counter += 1
            line = line.strip()
            
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ñ–æ—Ä–º–∞—Ç—É
            if re.match(r'^[^:]+:.+$', line):
                term, definition = map(str.strip, line.split(':', 1))
                normalized_term = term.lower()
                
                # –ü–æ–∏—Å–∫ —Ç–µ—Ä–º–∏–Ω–∞ –≤ —ç—Ç–∞–ª–æ–Ω–Ω–æ–º —Å–ª–æ–≤–∞—Ä–µ
                if normalized_term in answer_key:
                    correct_def = answer_key[normalized_term]
                    
                    # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π
                    if definition.lower() == correct_def.lower():
                        score += 1
                        feedback.append(f"[‚úì] –ü—Ä–∞–≤–∏–ª—å–Ω–æ: {term} - {definition}")
                        print(f"‚úÖ –°—Ç—Ä–æ–∫–∞ {line_counter}: –í–µ—Ä–Ω–æ! '{term}'")
                    else:
                        feedback.append(f"[√ó] –û—à–∏–±–∫–∞: {term}: –≤–∞—à –æ—Ç–≤–µ—Ç '{definition}', –ø—Ä–∞–≤–∏–ª—å–Ω–æ '{correct_def}'")
                        print(f"‚ùå –°—Ç—Ä–æ–∫–∞ {line_counter}: –ù–µ–≤–µ—Ä–Ω–æ! {term}")
                        print(f"    –í–∞—à –æ—Ç–≤–µ—Ç: '{definition}'")
                        print(f"    –≠—Ç–∞–ª–æ–Ω:    '{correct_def}'")
                else:
                    feedback.append(f"[?] –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–µ—Ä–º–∏–Ω: {term}")
                    print(f"‚ö†Ô∏è –°—Ç—Ä–æ–∫–∞ {line_counter}: –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–µ—Ä–º–∏–Ω '{term}'")
            else:
                feedback.append(f"[!] –û—à–∏–±–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞: {line}")
                print(f"‚õî –°—Ç—Ä–æ–∫–∞ {line_counter}: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç!")
    
    print("=" * 50)
    print(f"üìä –ò—Ç–æ–≥–æ–≤—ã–π –±–∞–ª–ª: {score}/{len(answer_key)}")
    return score, feedback

# –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –°–ö–†–ò–ü–¢–ê
if __name__ == "__main__":
    # –≠—Ç–∞–ª–æ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
    reference = {
        "—Ñ–æ—Ç–æ—Å–∏–Ω—Ç–µ–∑": "–ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Å–≤–µ—Ç–∞ –≤ —Ö–∏–º–∏—á–µ—Å–∫—É—é —ç–Ω–µ—Ä–≥–∏—é",
        "–º–∏—Ç–æ–∑": "–Ω–µ–ø—Ä—è–º–æ–µ –¥–µ–ª–µ–Ω–∏–µ –∫–ª–µ—Ç–∫–∏",
        "–º–µ–π–æ–∑": "—Ä–µ–¥—É–∫—Ü–∏–æ–Ω–Ω–æ–µ –¥–µ–ª–µ–Ω–∏–µ –∫–ª–µ—Ç–æ–∫"
    }
    
    # –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª —Å—Ç—É–¥–µ–Ω—Ç–∞
    with open("test_answers.txt", "w", encoding="utf-8") as f:
        f.write("–§–æ—Ç–æ—Å–∏–Ω—Ç–µ–∑: –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Å–≤–µ—Ç–∞ –≤ —Ö–∏–º–∏—á–µ—Å–∫—É—é —ç–Ω–µ—Ä–≥–∏—é\n")
        f.write("–ú–∏—Ç–æ–∑: –ø—Ä–æ—Å—Ç–æ–µ –¥–µ–ª–µ–Ω–∏–µ –∫–ª–µ—Ç–∫–∏\n")  # –û–ø–µ—á–∞—Ç–∫–∞
        f.write("–ú–µ–π–æ–∑: —Ä–µ–¥—É–∫—Ü–∏–æ–Ω–Ω–æ–µ –¥–µ–ª–µ–Ω–∏–µ –∫–ª–µ—Ç–æ–∫\n")
        f.write("–•–ª–æ—Ä–æ–ø–ª–∞—Å—Ç: –æ—Ä–≥–∞–Ω–æ–∏–¥ —Ä–∞—Å—Ç–∏—Ç–µ–ª—å–Ω–æ–π –∫–ª–µ—Ç–∫–∏\n")  # –õ–∏—à–Ω–∏–π —Ç–µ—Ä–º–∏–Ω
        f.write("–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –±–µ–∑ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è\n")
    
    # –ó–∞–ø—É—Å–∫ –ø—Ä–æ–≤–µ—Ä–∫–∏
    print("\nüöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏...")
    points, comments = check_answers("test_answers.txt", reference)
    
    # –í—ã–≤–æ–¥ –ø–æ–¥—Ä–æ–±–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    print("\nüìù –î–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç—á–µ—Ç:")
    for comment in comments:
        print(comment)
    
    print(f"\nüíØ –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞: {points} –∏–∑ {len(reference)} –±–∞–ª–ª–æ–≤")